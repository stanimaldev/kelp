(this["webpackJsonpreact-ravenous"]=this["webpackJsonpreact-ravenous"]||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"static/media/kelp.062a796b.png"},,,,function(e,t,n){e.exports=n(37)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(5),o=n.n(r),s=(n(22),n(16)),i=n(1),l=n(13),u=n.n(l),m=(n(23),n(24),n(25),n(26),n(2)),d=n(7),p=Object(d.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default biz",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BUSINESS_CLICKED":return t.payload;default:return e}}));p.subscribe((function(){return console.log(p.getState())}));var f=p;function b(e){var t=e.business,n=(e.clickOnBusiness,Object(m.c)((function(e){return e}))),a=Object(m.b)(),r=function(e){a(f(e)),console.log(n,"from Business Component!")};return c.a.createElement("div",{className:"Business"},c.a.createElement("div",{className:"image-container"}," ",c.a.createElement("img",{src:t.imageSrc,alt:t.coordinates.longitude.toFixed(4),onClick:function(){return r}})),c.a.createElement("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"Business-name"},c.a.createElement("h2",null,t.name)),c.a.createElement("div",{className:"Business-information"},c.a.createElement("div",{className:"Business-address"},c.a.createElement("a",{href:"https://www.google.com/maps/search/?api=1&query=".concat(t.address,"+").concat(t.city),target:"_blank",rel:"noopener noreferrer"},c.a.createElement("p",null,t.address),c.a.createElement("p",null,t.city),c.a.createElement("p",null,"".concat(t.state," ").concat(t.zipCode)))),c.a.createElement("div",{className:"Business-reviews"},t.category?c.a.createElement("h3",null,t.category.toUpperCase()):null,c.a.createElement("h3",{className:"rating"},"".concat(t.rating," stars")),c.a.createElement("p",null,"".concat(t.reviewCount," reviews")))))}var h=function(e){return c.a.createElement("div",{className:"BusinessList",style:e.style},e.businesses.map((function(t){return c.a.createElement(b,{business:t,className:"biz",key:t.id,clickOnBusiness:e.clickOnBusiness})})))};n(33);function g(e){var t=Object(a.useState)(""),n=Object(i.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1],d=Object(a.useState)("best_match"),p=Object(i.a)(d,2),f=p[0],b=p[1],h={"Best Match":"best_match","Highest Rated":"rating","Most Reviewed":"review_count"},g=function(e){return f===e?"active":""},v=function(){if(r&&u)e.searchYelp(r,u,f);else{var t=document.createElement("div"),n=document.createElement("p"),a=document.querySelector(".SearchBar-submit");t.setAttribute("style","display: flex; justify-content: center; position: absolute; width: 100%; margin-top: 35px;"),n.textContent="Must fill in all fields! \ud83e\uddd0",n.style.cssText="color: white; background: red; width: 300px; padding: 7px; border-radius: 7px; opacity: 0.9; display: flex; justify-content: center; font-size: 1.1rem",t.append(n),a.append(t),setTimeout((function(){a.removeChild(t)}),5e3)}},y=function(e){e.preventDefault(),13===e.keyCode&&v()};return c.a.createElement("div",{className:"SearchBar"},c.a.createElement("div",{className:"SearchBar-sort-options"},c.a.createElement("ul",null,Object.keys(h).map((function(e){var t=h[e];return c.a.createElement("li",{key:t,className:g(t),onClick:function(){return function(e){b(e),console.log(e),r&&u&&(console.log("sort option changed to ".concat(e)),v())}(t)}},e)})))),c.a.createElement("div",{className:"SearchBar-fields"},c.a.createElement("input",{className:"termInput",onChange:function(e){o(e.target.value)},placeholder:"Search Businesses",onKeyUp:y}),c.a.createElement("input",{className:"locationInput",onChange:function(e){m(e.target.value)},placeholder:"Where?",onKeyUp:y,value:u||""})),c.a.createElement("div",{className:"SearchBar-submit"},c.a.createElement("button",{onClick:v},"Let's Go")))}var v=n(11),y=n.n(v),E=n(15),w={search:function(){var e=Object(E.a)(y.a.mark((function e(t,n,a){var c,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://cors-anywhere.herokuapp.com/https://api.yelp.com/v3/businesses/search?term=".concat(t,"&location=").concat(n,"&sort_by=").concat(a),{headers:{Authorization:"Bearer ".concat("pNUUtdTjrkfUQQ6oulCCXktMcftn4rR1VUc2uKWt0uxxqOeoHUUvzS_CorL4NtLvK_TDzR7xYaNYy7W8umfbNPPKdHexEmhvZs9mZl1blmePnovnY9AT2CirAR_tXnYx")}});case 2:return c=e.sent,e.next=5,c.json();case 5:if(!(r=e.sent).businesses){e.next=8;break}return e.abrupt("return",r.businesses.map((function(e){return{id:e.id,imageSrc:e.image_url,url:e.url,name:e.name,address:e.location.address1,city:e.location.city,state:e.location.state,zipCode:e.location.zip_code,category:e.categories[0]?e.categories[0].title:null,rating:e.rating,reviewCount:e.review_count,coordinates:e.coordinates}})));case 8:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},k=n(4),j=n.n(k);n(35);function O(e){var t=e.onClick,n=e.businesses,r=(e.clickedBusiness,Object(a.useState)(!1)),o=Object(i.a)(r,2),s=o[0],l=o[1],u=Object(a.useState)(!1),d=Object(i.a)(u,2),p=d[0],f=d[1],b=Object(a.useState)(),h=Object(i.a)(b,2),g=h[0],v=h[1],y=Object(a.useRef)([]),E=Object(m.c)((function(e){return e})),w=Object(a.useCallback)((function(){!function(e){var t=window.document.getElementsByTagName("script")[0],n=window.document.createElement("script");n.src=e,t.parentNode.insertBefore(n,t),console.log("script loaded")}("https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"),window.initMap=k,window.initMap()}),[]),k=function(){j.a.accessToken="pk.eyJ1Ijoic3Rhbi1kZXYiLCJhIjoiY2tlYm9leWpjMGFpMjJ0cndybWdpbmVwMSJ9.I0CXw1DFG7WYKgyVm7x07A";var e=new j.a.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:[-96,37.8],zoom:3});e.on("load",(function(){v(e),e.resize()}))},O=Object(a.useCallback)((function(e){var t={type:"FeatureCollection",features:n.map((function(e){return{type:"Feature",geometry:{type:"Point",coordinates:[e.coordinates.longitude,e.coordinates.latitude]},properties:{title:e.name,address:e.address,city:e.city,category:e.category,url:e.url}}}))};y.current!==n&&(y.current.forEach((function(e){return e.remove()})),y.current=[],console.log("removeMarkers!",y)),t.features.forEach((function(t){var n=document.createElement("div");n.className="marker";var a,c=new j.a.Marker(n);function r(e){g.flyTo({center:e.geometry.coordinates,zoom:14})}c.setLngLat(t.geometry.coordinates).setPopup(new j.a.Popup({offset:25}).setHTML("<h3>"+t.properties.title+"</h3><p>"+t.properties.city+"</p>"+t.properties.category+'<a href="'+t.properties.url+'" target="_blank"><p>Yelp Page</p><a>')).addTo(g),y.current.push(c),console.log("currentMarkers!",y),a=t,g.flyTo({center:a.geometry.coordinates,zoom:10}),n.addEventListener("click",(function(e){r(t),console.log(y.current[2]._lngLat.lng.toFixed(4)),console.log("clicked",t)})),y.current.forEach((function(t){e&&(r(t),console.log("clicked",t))}))}))}),[n]);Object(a.useEffect)((function(){w(),console.log("rendermap")}),[w]),Object(a.useEffect)((function(){O()}),[n]),Object(a.useEffect)((function(){var e=document.querySelector("#mapContainer");document.querySelector(".mapButton").addEventListener("click",(function(){"block"===e.style.display?e.style.display="none":e.style.display="block"}))}),[]);var x=s?"Hide Map":"Show Map";return c.a.createElement("div",{className:"mapBackground"},c.a.createElement("div",{className:"mapButtContainer"},c.a.createElement("button",{className:"mapButton",onClick:function(){console.log(E,"map toggle"),p||f(!0),t(),l((function(e){return!e})),setTimeout((function(){window.dispatchEvent(new Event("resize"))}),0)}},x)),c.a.createElement("div",{id:"mapContainer"},c.a.createElement("div",{id:"map"})))}n(36);function x(){return c.a.createElement("svg",{className:"spinner",width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("circle",{className:"path",fill:"none",strokeWidth:"6",strokeLinecap:"round",cx:"33",cy:"33",r:"30"}))}function N(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),l=Object(i.a)(o,2),m=l[0],d=l[1],p=Object(a.useState)(!1),f=Object(i.a)(p,2),b=f[0],v=f[1],y=Object(a.useState)(),E=Object(i.a)(y,2),k=E[0],j=E[1],N=Object(a.useState)(!1),C=Object(i.a)(N,2),B=C[0],S=C[1];Object(a.useEffect)((function(){n&&d(!1)}),[n,d]);Object(a.useEffect)((function(){window.addEventListener("resize",(function(){var e=window.innerWidth||document.documentElement.clientWidth;e<900&&S(!0),e>900&&S(!1)}))}),[B]);var z=b&&!B?{width:"50%"}:{width:"100%"};return c.a.createElement("div",{className:"App"},c.a.createElement("h1",{className:"logo-container"},c.a.createElement("a",{href:"/",className:"logo",style:{textDecoration:"none",color:"white"}},c.a.createElement("span",null,"kelp"),c.a.createElement("img",{src:u.a,alt:"kelp logo",height:"30px"}))),c.a.createElement(g,{searchYelp:function(e,t,n){d(!0),w.search(e,t,n).then((function(e){if(r([]),!e||e.length<1){var t=document.createElement("p"),n=document.querySelector(".noresults");t.textContent="No results found! \ud83d\ude31\ud83d\ude22",t.style.cssText="color: white; background: red; padding: 10px; border-radius: 4px; text-align: center; width: 300px; font-size: 1.3rem",n.append(t),console.log("NOTHING FOUND!"),setTimeout((function(){n.removeChild(t)}),5e3)}else r(Object(s.a)(e))}))}}),c.a.createElement("div",{className:"noresults",style:{width:"100%",display:"flex",justifyContent:"center",marginTop:"30px",position:"absolute"}}),c.a.createElement("div",{id:"mapComponent",className:"sticky"},c.a.createElement(O,{onClick:function(){v((function(e){return!e}))},businesses:n,clickedBusiness:k})),c.a.createElement("div",{style:z,className:"BizListContainer"},m?c.a.createElement("div",{className:"loader"},c.a.createElement(x,{style:{display:"flex",alignItems:"center",justifyContent:"center"}})):c.a.createElement(h,{businesses:n,clickOnBusiness:function(e){j(e)}})))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(m.a,{store:f},c.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[17,1,2]]]);
//# sourceMappingURL=main.061b9c82.chunk.js.map